<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Framework de Precifica√ß√£o MCMV</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background-color: #f9fafb;
      color: #1f2937;
      line-height: 1.5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .header {
      background: linear-gradient(135deg, #3b82f6, #10b981);
      color: white;
      padding: 32px 24px;
      border-radius: 12px 12px 0 0;
    }
    
    .header h1 {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .header p {
      opacity: 0.9;
      font-size: 16px;
    }
    
    .progress-container {
      background-color: #f3f4f6;
      padding: 16px 24px;
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 14px;
      color: #4b5563;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, #3b82f6, #10b981);
      border-radius: 4px;
      transition: width 0.3s ease;
    }
    
    .steps-navigation {
      display: flex;
      gap: 8px;
      padding: 16px;
      background-color: white;
      border-bottom: 1px solid #e5e7eb;
      overflow-x: auto;
    }
    
    .step-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      white-space: nowrap;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      background-color: #f3f4f6;
      color: #6b7280;
    }
    
    .step-button.active {
      background-color: #dbeafe;
      color: #1d4ed8;
      border: 2px solid #93c5fd;
    }
    
    .step-button.completed {
      background-color: #dcfce7;
      color: #166534;
    }
    
    .content-container {
      padding: 24px;
      background-color: white;
    }
    
    .step-header {
      margin-bottom: 24px;
    }
    
    .step-header h2 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .step-header p {
      color: #4b5563;
    }
    
    .info-box {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 24px;
      display: flex;
      gap: 12px;
    }
    
    .info-box.blue {
      background-color: #dbeafe;
      color: #1e40af;
    }
    
    .info-box.yellow {
      background-color: #fef3c7;
      color: #92400e;
    }
    
    .info-box.green {
      background-color: #dcfce7;
      color: #166534;
    }
    
    .info-box.purple {
      background-color: #ede9fe;
      color: #5b21b6;
    }
    
    .info-box-content h4 {
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    .info-box-content p {
      font-size: 14px;
    }
    
    .grid-2 {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
    }
    
    .grid-3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    
    .input-group {
      margin-bottom: 16px;
    }
    
    .input-group label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 8px;
      color: #374151;
    }
    
    .input-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    
    .input-group input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    
    .input-group p {
      font-size: 12px;
      color: #6b7280;
      margin-top: 4px;
    }
    
    .button {
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      border: none;
      font-size: 14px;
    }
    
    .button.primary {
      background-color: #3b82f6;
      color: white;
    }
    
    .button.primary:hover {
      background-color: #2563eb;
    }
    
    .button.danger {
      background-color: #ef4444;
      color: white;
    }
    
    .button.danger:hover {
      background-color: #dc2626;
    }
    
    .competitor-card {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      background-color: #f9fafb;
      margin-bottom: 16px;
    }
    
    .competitor-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    
    .competitor-header h4 {
      font-weight: 600;
    }
    
    .summary-box {
      padding: 16px;
      border-radius: 8px;
      margin-top: 16px;
    }
    
    .summary-box.blue {
      background-color: #dbeafe;
    }
    
    .summary-box.green {
      background-color: #dcfce7;
    }
    
    .summary-box.yellow {
      background-color: #fef3c7;
    }
    
    .summary-box.orange {
      background-color: #ffedd5;
    }
    
    .summary-box h4 {
      font-weight: 600;
      margin-bottom: 12px;
    }
    
    .strategy-option {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .strategy-option:hover {
      background-color: #f9fafb;
    }
    
    .strategy-option label {
      display: flex;
      gap: 12px;
      cursor: pointer;
    }
    
    .strategy-option-content h4 {
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    .strategy-option-content.green h4 {
      color: #166534;
    }
    
    .strategy-option-content.blue h4 {
      color: #1d4ed8;
    }
    
    .strategy-option-content.orange h4 {
      color: #9a3412;
    }
    
    .strategy-option-content p {
      font-size: 14px;
      color: #4b5563;
      margin-bottom: 8px;
    }
    
    .strategy-option-content div {
      font-size: 12px;
      font-weight: 500;
    }
    
    .result-card {
      background-color: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 20px;
    }
    
    .result-highlight {
      background: linear-gradient(135deg, #3b82f6, #10b981);
      color: white;
      padding: 24px;
      border-radius: 12px;
      margin: 24px 0;
    }
    
    .result-highlight h4 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
    }
    
    .result-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    
    .result-item {
      background-color: rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      padding: 16px;
    }
    
    .result-item-value {
      font-size: 24px;
      font-weight: 700;
      margin: 8px 0;
    }
    
    .result-item-label {
      font-size: 14px;
      opacity: 0.85;
    }
    
    .validation-box {
      padding: 20px;
      border-radius: 12px;
      margin: 24px 0;
    }
    
    .validation-box.green {
      background-color: #dcfce7;
      border: 1px solid #bbf7d0;
    }
    
    .validation-box.yellow {
      background-color: #fef3c7;
      border: 1px solid #fde68a;
    }
    
    .navigation {
      display: flex;
      justify-content: space-between;
      padding: 16px 24px;
      background-color: #f3f4f6;
    }
    
    .flex-center {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .icon {
      width: 20px;
      height: 20px;
    }
    
    .text-green {
      color: #16a34a;
    }
    
    .text-red {
      color: #dc2626;
    }
    
    .text-blue {
      color: #2563eb;
    }
    
    .text-yellow {
      color: #ca8a04;
    }
    
    .text-sm {
      font-size: 14px;
    }
    
    .font-medium {
      font-weight: 500;
    }
    
    .font-bold {
      font-weight: 700;
    }
    
    .mb-2 {
      margin-bottom: 8px;
    }
    
    .mb-3 {
      margin-bottom: 12px;
    }
    
    .mb-4 {
      margin-bottom: 16px;
    }
    
    .mt-1 {
      margin-top: 4px;
    }
    
    .mt-2 {
      margin-top: 8px;
    }
    
    .p-4 {
      padding: 16px;
    }
    
    .space-y-4 > * + * {
      margin-top: 16px;
    }
    
    .space-y-6 > * + * {
      margin-top: 24px;
    }
    
    .text-center {
      text-align: center;
    }
    
    .py-8 {
      padding-top: 32px;
      padding-bottom: 32px;
    }
    
    .hidden {
      display: none;
    }
    
    @media (max-width: 768px) {
      .grid-2,
      .grid-3,
      .result-grid {
        grid-template-columns: 1fr;
      }
      
      .steps-navigation {
        flex-wrap: wrap;
      }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Estados da aplica√ß√£o
      const state = {
        currentStep: 0,
        formData: {
          populacaoTotal: '',
          taxaCrescimento: '',
          migracaoInterna: '',
          familiasFaixa1: '',
          familiasFaixa2: '',
          familiasFaixa3: '',
          deficitHabitacional: '',
          concorrentes: [],
          custoTerreno: '',
          custoConstrucao: '',
          custosIndiretos: '',
          margemDesejada: '',
          precoIdeal: '',
          precoMaximo: '',
          precoSuspeito: '',
          estrategia: '',
          vsoMeta: ''
        },
        results: {
          som: 0,
          precoMinimo: 0,
          precoSugerido: 0,
          vsoProjetada: 0,
          margemFinal: 0
        },
        steps: [
          { id: 'demanda', title: 'An√°lise de Demanda', icon: 'users', description: 'Calcular TAM/SAM/SOM do mercado' },
          { id: 'competitiva', title: 'An√°lise Competitiva', icon: 'chart-line', description: 'Mapear concorr√™ncia e posicionamento' },
          { id: 'financeira', title: 'An√°lise Financeira', icon: 'calculator', description: 'Calcular custos e margem m√≠nima' },
          { id: 'pesquisa', title: 'Pesquisa de Mercado', icon: 'bullseye', description: 'Validar inten√ß√£o de compra' },
          { id: 'estrategia', title: 'Estrat√©gia de Pre√ßo', icon: 'dollar-sign', description: 'Definir abordagem de precifica√ß√£o' },
          { id: 'resultados', title: 'Resultados', icon: 'bar-chart', description: 'An√°lise final e recomenda√ß√µes' }
        ]
      };

      // Fun√ß√µes utilit√°rias
      function updateFormData(field, value) {
        const numericFields = [
          'populacaoTotal', 'taxaCrescimento', 'migracaoInterna', 'familiasFaixa1',
          'familiasFaixa2', 'familiasFaixa3', 'deficitHabitacional', 'custoTerreno',
          'custoConstrucao', 'custosIndiretos', 'margemDesejada', 'precoIdeal',
          'precoMaximo', 'precoSuspeito', 'vsoMeta'
        ];
        
        if (numericFields.includes(field)) {
          const numValue = parseFloat(value);
          if (!isNaN(numValue)) {
            state.formData[field] = Math.max(0, numValue).toString();
          } else {
            state.formData[field] = value;
          }
        } else {
          state.formData[field] = value;
        }
        calculateResults();
        render();
      }
      
      function addConcorrente() {
        state.formData.concorrentes.push({
          nome: '',
          preco: '',
          metragem: '',
          localizacao: '',
          diferencial: '',
          vso: ''
        });
        render();
      }
      
      function updateConcorrente(index, field, value) {
        const numericFields = ['preco', 'metragem', 'vso'];
        if (numericFields.includes(field)) {
          const numValue = parseFloat(value);
          if (!isNaN(numValue)) {
            state.formData.concorrentes[index][field] = Math.max(0, numValue).toString();
          } else {
            state.formData.concorrentes[index][field] = value;
          }
        } else {
          state.formData.concorrentes[index][field] = value;
        }
        render();
      }
      
      function removeConcorrente(index) {
        state.formData.concorrentes = state.formData.concorrentes.filter((_, i) => i !== index);
        render();
      }
      
      function calculateResults() {
        const formData = state.formData;
        const populacao = parseFloat(formData.populacaoTotal) || 0;
        const familiasFaixa = (parseFloat(formData.familiasFaixa1) || 0) + 
                             (parseFloat(formData.familiasFaixa2) || 0) + 
                             (parseFloat(formData.familiasFaixa3) || 0);
        
        // SOM Calculation
        state.results.som = Math.round((familiasFaixa * 0.3 * 0.15) / 24);
        
        // Pre√ßo M√≠nimo
        const custoTotal = (parseFloat(formData.custoTerreno) || 0) + 
                          (parseFloat(formData.custoConstrucao) || 0) + 
                          (parseFloat(formData.custosIndiretos) || 0);
        const margemMin = parseFloat(formData.margemDesejada) || 25;
        state.results.precoMinimo = Math.round(custoTotal * (1 + margemMin/100) * 1.1);
        
        // Pre√ßo Sugerido baseado na estrat√©gia
        let precoSugerido = state.results.precoMinimo;
        const precoMedio = formData.concorrentes.reduce((acc, comp) => 
          acc + (parseFloat(comp.preco) || 0), 0) / (formData.concorrentes.length || 1);
        
        switch(formData.estrategia) {
          case 'valor':
            precoSugerido = Math.max(state.results.precoMinimo, precoMedio * 1.1);
            break;
          case 'competitiva':
            precoSugerido = Math.max(state.results.precoMinimo, precoMedio);
            break;
          case 'penetracao':
            precoSugerido = Math.max(state.results.precoMinimo, precoMedio * 0.95);
            break;
          default:
            precoSugerido = state.results.precoMinimo;
        }
        
        state.results.precoSugerido = Math.round(precoSugerido);
        
        // VSO Projetada
        const vsoBase = parseFloat(formData.vsoMeta) || 2.5;
        const ajustePreco = state.results.precoSugerido < precoMedio ? 1.3 : 
                           (state.results.precoSugerido > precoMedio * 1.1 ? 0.8 : 1);
        state.results.vsoProjetada = parseFloat((vsoBase * ajustePreco).toFixed(2));
        
        // Margem Final
        state.results.margemFinal = parseFloat((((state.results.precoSugerido - custoTotal) / state.results.precoSugerido) * 100).toFixed(1));
      }
      
      // Fun√ß√µes de renderiza√ß√£o
      function renderStep() {
        const step = state.steps[state.currentStep].id;
        if (step === 'demanda') return renderDemanda();
        if (step === 'competitiva') return renderCompetitiva();
        if (step === 'financeira') return renderFinanceira();
        if (step === 'pesquisa') return renderPesquisa();
        if (step === 'estrategia') return renderEstrategia();
        if (step === 'resultados') return renderResultados();
        return '<div>Etapa n√£o encontrada</div>';
      }
      
      function renderDemanda() {
        const formData = state.formData;
        const results = state.results;
        return `
          <div class="space-y-6">
            <div class="info-box blue">
              <div class="flex-center">
                <i class="fas fa-info-circle icon"></i>
                <div>
                  <h4 class="font-medium">Dados Demogr√°ficos</h4>
                  <p class="text-sm">Colete dados do IBGE, Receita Federal e √≥rg√£os locais</p>
                </div>
              </div>
            </div>
            
            <div class="grid-2">
              <div class="input-group">
                <label>Popula√ß√£o Total da Cidade</label>
                <input
                  type="number"
                  value="${formData.populacaoTotal}"
                  onchange="updateFormData('populacaoTotal', this.value)"
                  placeholder="Ex: 150000"
                  min="0"
                />
              </div>
              
              <div class="input-group">
                <label>Taxa Crescimento Anual (%)</label>
                <input
                  type="number"
                  step="0.1"
                  value="${formData.taxaCrescimento}"
                  onchange="updateFormData('taxaCrescimento', this.value)"
                  placeholder="Ex: 2.5"
                  min="0"
                />
              </div>
              
              <div class="input-group">
                <label>Migra√ß√£o Interna (pessoas/ano)</label>
                <input
                  type="number"
                  value="${formData.migracaoInterna}"
                  onchange="updateFormData('migracaoInterna', this.value)"
                  placeholder="Ex: 2000"
                  min="0"
                />
              </div>
              
              <div class="input-group">
                <label>D√©ficit Habitacional (%)</label>
                <input
                  type="number"
                  step="0.1"
                  value="${formData.deficitHabitacional}"
                  onchange="updateFormData('deficitHabitacional', this.value)"
                  placeholder="Ex: 12.5"
                  min="0"
                />
              </div>
            </div>
            
            <div class="summary-box">
              <h4 class="font-medium mb-3">Distribui√ß√£o de Fam√≠lias MCMV</h4>
              <div class="grid-3">
                <div class="input-group">
                  <label class="text-sm">Faixa 1 (at√© R$ 2.640)</label>
                  <input
                    type="number"
                    value="${formData.familiasFaixa1}"
                    onchange="updateFormData('familiasFaixa1', this.value)"
                    placeholder="N¬∫ fam√≠lias"
                    min="0"
                  />
                </div>
                <div class="input-group">
                  <label class="text-sm">Faixa 2 (R$ 2.640-4.400)</label>
                  <input
                    type="number"
                    value="${formData.familiasFaixa2}"
                    onchange="updateFormData('familiasFaixa2', this.value)"
                    placeholder="N¬∫ fam√≠lias"
                    min="0"
                  />
                </div>
                <div class="input-group">
                  <label class="text-sm">Faixa 3 (R$ 4.400-8.000)</label>
                  <input
                    type="number"
                    value="${formData.familiasFaixa3}"
                    onchange="updateFormData('familiasFaixa3', this.value)"
                    placeholder="N¬∫ fam√≠lias"
                    min="0"
                  />
                </div>
              </div>
            </div>
            
            ${formData.populacaoTotal ? `
              <div class="info-box green">
                <h4 class="font-medium mb-2">Indicadores Calculados</h4>
                <div class="grid-2">
                  <div>
                    <span>N√∫mero estimado de fam√≠lias:</span>
                    <span class="font-medium ml-2">${Math.round(parseFloat(formData.populacaoTotal) / 3.2).toLocaleString()}</span>
                  </div>
                  <div>
                    <span>SOM estimado (24 meses):</span>
                    <span class="font-medium ml-2 text-green">${results.som} unidades</span>
                  </div>
                </div>
              </div>
            ` : ''}
          </div>
        `;
      }
      
      function renderCompetitiva() {
        const formData = state.formData;
        return `
          <div class="space-y-6">
            <div class="info-box yellow">
              <div class="flex-center">
                <i class="fas fa-info-circle icon"></i>
                <div>
                  <h4 class="font-medium">An√°lise Competitiva</h4>
                  <p class="text-sm">Mapeie empreendimentos similares lan√ßados nos √∫ltimos 2 anos</p>
                </div>
              </div>
            </div>
            
            <div class="flex justify-between items-center mb-4">
              <h3 class="font-medium">Concorrentes Mapeados</h3>
              <button onclick="addConcorrente()" class="button primary">
                + Adicionar Concorrente
              </button>
            </div>
            
            <div class="space-y-4">
              ${formData.concorrentes.length > 0 ? 
                formData.concorrentes.map((concorrente, index) => `
                  <div class="competitor-card">
                    <div class="competitor-header">
                      <h4>Concorrente ${index + 1}</h4>
                      <button onclick="removeConcorrente(${index})" class="text-red">
                        Remover
                      </button>
                    </div>
                    
                    <div class="grid-3">
                      <div class="input-group">
                        <label class="text-sm font-medium">Nome do Empreendimento</label>
                        <input
                          type="text"
                          value="${concorrente.nome}"
                          onchange="updateConcorrente(${index}, 'nome', this.value)"
                          placeholder="Ex: Residencial Aurora"
                        />
                      </div>
                      
                      <div class="input-group">
                        <label class="text-sm font-medium">Pre√ßo (R$)</label>
                        <input
                          type="number"
                          value="${concorrente.preco}"
                          onchange="updateConcorrente(${index}, 'preco', this.value)"
                          placeholder="Ex: 190000"
                          min="0"
                        />
                      </div>
                      
                      <div class="input-group">
                        <label class="text-sm font-medium">Metragem (m¬≤)</label>
                        <input
                          type="number"
                          value="${concorrente.metragem}"
                          onchange="updateConcorrente(${index}, 'metragem', this.value)"
                          placeholder="Ex: 45"
                          min="0"
                        />
                      </div>
                      
                      <div class="input-group">
                        <label class="text-sm font-medium">Localiza√ß√£o</label>
                        <input
                          type="text"
                          value="${concorrente.localizacao}"
                          onchange="updateConcorrente(${index}, 'localizacao', this.value)"
                          placeholder="Ex: Bairro Centro"
                        />
                      </div>
                      
                      <div class="input-group">
                        <label class="text-sm font-medium">Principal Diferencial</label>
                        <input
                          type="text"
                          value="${concorrente.diferencial}"
                          onchange="updateConcorrente(${index}, 'diferencial', this.value)"
                          placeholder="Ex: Academia, Piscina"
                        />
                      </div>
                      
                      <div class="input-group">
                        <label class="text-sm font-medium">VSO (un/m√™s)</label>
                        <input
                          type="number"
                          step="0.1"
                          value="${concorrente.vso}"
                          onchange="updateConcorrente(${index}, 'vso', this.value)"
                          placeholder="Ex: 25"
                          min="0"
                        />
                      </div>
                    </div>
                  </div>
                `).join('') : `
                  <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-chart-line fa-3x mb-3 opacity-50"></i>
                    <p>Adicione concorrentes para an√°lise comparativa</p>
                  </div>
                `}
            </div>
            
            ${formData.concorrentes.length > 0 ? `
              <div class="info-box blue">
                <h4 class="font-medium mb-2">Resumo Competitivo</h4>
                <div class="grid-3">
                  <div>
                    <span>Pre√ßo m√©dio:</span>
                    <span class="font-medium ml-2">
                      R$ ${(formData.concorrentes.reduce((acc, comp) => acc + (parseFloat(comp.preco) || 0), 0) / formData.concorrentes.length).toLocaleString('pt-BR')}
                    </span>
                  </div>
                  <div>
                    <span>Metragem m√©dia:</span>
                    <span class="font-medium ml-2">
                      ${(formData.concorrentes.reduce((acc, comp) => acc + (parseFloat(comp.metragem) || 0), 0) / formData.concorrentes.length).toFixed(0)}m¬≤
                    </span>
                  </div>
                  <div>
                    <span>VSO m√©dio:</span>
                    <span class="font-medium ml-2">
                      ${(formData.concorrentes.reduce((acc, comp) => acc + (parseFloat(comp.vso) || 0), 0) / formData.concorrentes.length).toFixed(1)} un/m√™s
                    </span>
                  </div>
                </div>
              </div>
            ` : ''}
          </div>
        `;
      }
      
      function renderFinanceira() {
        const formData = state.formData;
        const results = state.results;
        return `
          <div class="space-y-6">
            <div class="info-box green">
              <div class="flex-center">
                <i class="fas fa-info-circle icon"></i>
                <div>
                  <h4 class="font-medium">Estrutura de Custos</h4>
                  <p class="text-sm">Calcule todos os custos para definir o pre√ßo m√≠nimo vi√°vel</p>
                </div>
              </div>
            </div>
            
            <div class="grid-2">
              <div class="input-group">
                <label>Custo do Terreno (R$/m¬≤ constru√≠do)</label>
                <input
                  type="number"
                  value="${formData.custoTerreno}"
                  onchange="updateFormData('custoTerreno', this.value)"
                  placeholder="Ex: 250"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">Incluir custo de oportunidade e despesas cartoriais</p>
              </div>
              
              <div class="input-group">
                <label>Custo de Constru√ß√£o (R$/m¬≤)</label>
                <input
                  type="number"
                  value="${formData.custoConstrucao}"
                  onchange="updateFormData('custoConstrucao', this.value)"
                  placeholder="Ex: 1200"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">CUB + margem de seguran√ßa de obras</p>
              </div>
              
              <div class="input-group">
                <label>Custos Indiretos (R$/m¬≤)</label>
                <input
                  type="number"
                  value="${formData.custosIndiretos}"
                  onchange="updateFormData('custosIndiretos', this.value)"
                  placeholder="Ex: 200"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">Projetos, aprova√ß√µes, marketing, vendas, administra√ß√£o</p>
              </div>
              
              <div class="input-group">
                <label>Margem Desejada (%)</label>
                <input
                  type="number"
                  step="0.1"
                  value="${formData.margemDesejada}"
                  onchange="updateFormData('margemDesejada', this.value)"
                  placeholder="Ex: 25"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">Margem l√≠quida ap√≥s impostos e financeiro</p>
              </div>
            </div>
            
            ${formData.custoTerreno && formData.custoConstrucao ? `
              <div class="summary-box">
                <h4 class="font-medium mb-3">An√°lise de Custos</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span>Custo Total Direto:</span>
                    <span class="font-medium">
                      R$ ${((parseFloat(formData.custoTerreno) || 0) + 
                           (parseFloat(formData.custoConstrucao) || 0) + 
                           (parseFloat(formData.custosIndiretos) || 0)).toLocaleString('pt-BR')}/m¬≤
                    </span>
                  </div>
                  <div class="flex justify-between text-red">
                    <span>Pre√ßo M√≠nimo (com margem):</span>
                    <span class="font-medium">R$ ${results.precoMinimo.toLocaleString('pt-BR')}/m¬≤</span>
                  </div>
                  <div class="flex justify-between text-yellow">
                    <span>Margem de Seguran√ßa:</span>
                    <span class="font-medium">10% sobre margem desejada</span>
                  </div>
                </div>
              </div>
            ` : ''}
            
            <div class="info-box yellow">
              <h4 class="font-medium mb-2">‚ö†Ô∏è Pontos de Aten√ß√£o</h4>
              <ul class="text-sm space-y-1">
                <li>‚Ä¢ Considere varia√ß√£o do CUB durante a obra (+5-10%)</li>
                <li>‚Ä¢ Reserve capital de giro para 6-12 meses</li>
                <li>‚Ä¢ Avalie impacto de distratos na margem final</li>
                <li>‚Ä¢ Custos financeiros do cronograma de recebimento</li>
              </ul>
            </div>
          </div>
        `;
      }
      
      function renderPesquisa() {
        const formData = state.formData;
        return `
          <div class="space-y-6">
            <div class="info-box purple">
              <div class="flex-center">
                <i class="fas fa-info-circle icon"></i>
                <div>
                  <h4 class="font-medium">Pesquisa de Inten√ß√£o de Compra</h4>
                  <p class="text-sm">Valide a sensibilidade ao pre√ßo do p√∫blico-alvo</p>
                </div>
              </div>
            </div>
            
            <div class="info-box blue">
              <h4 class="font-medium mb-2">üìã Como Conduzir a Pesquisa</h4>
              <div class="text-sm space-y-2">
                <p><strong>Pergunta-chave:</strong> "Para uma fam√≠lia com renda de R$ X, qual seria o valor m√°ximo que pagaria por um apartamento de XXm¬≤ no bairro Y, considerando financiamento MCMV?"</p>
                <p><strong>Canais sugeridos:</strong> Stands de vendas, redes sociais, pesquisa telef√¥nica, eventos imobili√°rios</p>
                <p><strong>Amostra m√≠nima:</strong> 200+ pessoas da faixa de renda MCMV</p>
              </div>
            </div>
            
            <div class="grid-3">
              <div class="input-group">
                <label>Pre√ßo Ideal (R$)</label>
                <input
                  type="number"
                  value="${formData.precoIdeal}"
                  onchange="updateFormData('precoIdeal', this.value)"
                  placeholder="Ex: 180000"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">Pre√ßo mais citado na pesquisa</p>
              </div>
              
              <div class="input-group">
                <label>Pre√ßo M√°ximo Aceit√°vel (R$)</label>
                <input
                  type="number"
                  value="${formData.precoMaximo}"
                  onchange="updateFormData('precoMaximo', this.value)"
                  placeholder="Ex: 220000"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">Limite superior de aceita√ß√£o</p>
              </div>
              
              <div class="input-group">
                <label>Pre√ßo Suspeito (R$)</label>
                <input
                  type="number"
                  value="${formData.precoSuspeito}"
                  onchange="updateFormData('precoSuspeito', this.value)"
                  placeholder="Ex: 150000"
                  min="0"
                />
                <p class="text-xs text-gray-500 mt-1">Pre√ßo considerado "muito barato"</p>
              </div>
            </div>
            
            ${formData.precoIdeal && formData.precoMaximo ? `
              <div class="info-box green">
                <h4 class="font-medium mb-2">An√°lise de Sensibilidade</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span>Faixa de Pre√ßo Aceit√°vel:</span>
                    <span class="font-medium">
                      R$ ${parseFloat(formData.precoIdeal).toLocaleString('pt-BR')} - R$ ${parseFloat(formData.precoMaximo).toLocaleString('pt-BR')}
                    </span>
                  </div>
                  <div class="flex justify-between">
                    <span>Elasticidade Estimada:</span>
                    <span class="font-medium">
                      ${(((parseFloat(formData.precoMaximo) - parseFloat(formData.precoIdeal)) / parseFloat(formData.precoIdeal) * 100).toFixed(1)}% de varia√ß√£o
                    </span>
                  </div>
                  <div class="flex justify-between">
                    <span>Sweet Spot Recomendado:</span>
                    <span class="font-medium text-green">
                      R$ ${((parseFloat(formData.precoIdeal) + parseFloat(formData.precoMaximo)) / 2).toLocaleString('pt-BR')}
                    </span>
                  </div>
                </div>
              </div>
            ` : ''}
            
            <div class="info-box orange">
              <h4 class="font-medium mb-2">üéØ Dicas para Valida√ß√£o</h4>
              <ul class="text-sm space-y-1">
                <li>‚Ä¢ Compare resultados com an√°lise competitiva</li>
                <li>‚Ä¢ Teste diferentes perfis de renda na mesma pesquisa</li>
                <li>‚Ä¢ Valide diferencial de pre√ßo por localiza√ß√£o</li>
                <li>‚Ä¢ Considere sazonalidade na pesquisa (evitar dezembro/janeiro)</li>
              </ul>
            </div>
          </div>
        `;
      }
      
      function renderEstrategia() {
        const formData = state.formData;
        return `
          <div class="space-y-6">
            <div class="info-box purple">
              <div class="flex-center">
                <i class="fas fa-info-circle icon"></i>
                <div>
                  <h4 class="font-medium">Estrat√©gia de Precifica√ß√£o</h4>
                  <p class="text-sm">Escolha a abordagem mais adequada para seu projeto</p>
                </div>
              </div>
            </div>
            
            <div class="space-y-4">
              <div class="strategy-option" onclick="updateFormData('estrategia', 'valor')">
                <label class="flex items-start">
                  <input
                    type="radio"
                    name="estrategia"
                    value="valor"
                    ${formData.estrategia === 'valor' ? 'checked' : ''}
                  />
                  <div class="strategy-option-content green">
                    <h4>Precifica√ß√£o por Valor</h4>
                    <p>Pre√ßo baseado no valor percebido pelos clientes. Ideal quando voc√™ tem diferenciais √∫nicos e superiores √† concorr√™ncia.</p>
                    <div class="text-green">
                      <strong>Quando usar:</strong> Localiza√ß√£o premium, acabamentos superiores, infraestrutura diferenciada
                    </div>
                  </div>
                </label>
              </div>
              
              <div class="strategy-option" onclick="updateFormData('estrategia', 'competitiva')">
                <label class="flex items-start">
                  <input
                    type="radio"
                    name="estrategia"
                    value="competitiva"
                    ${formData.estrategia === 'competitiva' ? 'checked' : ''}
                  />
                  <div class="strategy-option-content blue">
                    <h4>Precifica√ß√£o Competitiva</h4>
                    <p>Pre√ßo similar ao mercado, competindo em outros fatores como prazo de entrega, facilidade de aprova√ß√£o ou atendimento.</p>
                    <div class="text-blue">
                      <strong>Quando usar:</strong> Mercado estabelecido, produto similar aos concorrentes, foco na execu√ß√£o
                    </div>
                  </div>
                </label>
              </div>
              
              <div class="strategy-option" onclick="updateFormData('estrategia', 'penetracao')">
                <label class="flex items-start">
                  <input
                    type="radio"
                    name="estrategia"
                    value="penetracao"
                    ${formData.estrategia === 'penetracao' ? 'checked' : ''}
                  />
                  <div class="strategy-option-content orange">
                    <h4>Precifica√ß√£o de Penetra√ß√£o</h4>
                    <p>Pre√ßo abaixo do mercado para ganhar participa√ß√£o rapidamente. Estrat√©gia de volume com margem reduzida.</p>
                    <div class="text-orange">
                      <strong>Quando usar:</strong> Entrada em novo mercado, necessidade de VSO alta, concorr√™ncia forte
                    </div>
                  </div>
                </label>
              </div>
            </div>
            
            <div class="input-group">
              <label>Meta de VSO (% estoque/m√™s)</label>
              <input
                type="number"
                step="0.1"
                value="${formData.vsoMeta}"
                onchange="updateFormData('vsoMeta', this.value)"
                placeholder="Ex: 2.5"
                min="0"
              />
              <p class="text-xs text-gray-500 mt-1">
                Refer√™ncia: Mercado normal 2-3%, aquecido 3-5%, fraco 1-2%
              </p>
            </div>
            
            ${formData.estrategia ? `
              <div class="summary-box">
                <h4 class="font-medium mb-2">Impactos da Estrat√©gia Escolhida</h4>
                <div class="text-sm space-y-1">
                  ${formData.estrategia === 'valor' ? `
                    <p class="text-green">‚úì Maior margem de lucro</p>
                    <p class="text-green">‚úì Posicionamento premium</p>
                    <p class="text-red">‚ö† VSO mais baixa</p>
                    <p class="text-red">‚ö† Risco de estoque parado</p>
                  ` : ''}
                  ${formData.estrategia === 'competitiva' ? `
                    <p class="text-blue">‚úì Risco equilibrado</p>
                    <p class="text-blue">‚úì VSO previs√≠vel</p>
                    <p class="text-yellow">‚ö† Margem m√©dia</p>
                    <p class="text-yellow">‚ö† Dependente da execu√ß√£o</p>
                  ` : ''}
                  ${formData.estrategia === 'penetracao' ? `
                    <p class="text-orange">‚úì VSO alta</p>
                    <p class="text-orange">‚úì R√°pida penetra√ß√£o</p>
                    <p class="text-red">‚ö† Margem reduzida</p>
                    <p class="text-red">‚ö† Pode prejudicar brand</p>
                  ` : ''}
                </div>
              </div>
            ` : ''}
          </div>
        `;
      }
      
      function renderResultados() {
        const formData = state.formData;
        const results = state.results;
        return `
          <div class="space-y-6">
            <div class="result-highlight">
              <h4 class="font-bold">üìä An√°lise Final e Recomenda√ß√µes</h4>
            </div>
            
            <div class="grid-2">
              <div class="result-card">
                <h4 class="font-medium mb-3">Indicadores de Demanda</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span>SOM (24 meses):</span>
                    <span class="font-medium">${results.som} unidades</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Fam√≠lias eleg√≠veis:</span>
                    <span class="font-medium">
                      ${((parseFloat(formData.familiasFaixa1) || 0) + 
                        (parseFloat(formData.familiasFaixa2) || 0) + 
                        (parseFloat(formData.familiasFaixa3) || 0)).toLocaleString()}
                    </span>
                  </div>
                </div>
              </div>
              
              <div class="result-card">
                <h4 class="font-medium mb-3">An√°lise Competitiva</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span>Concorrentes mapeados:</span>
                    <span class="font-medium">${formData.concorrentes.length}</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Pre√ßo m√©dio mercado:</span>
                    <span class="font-medium">
                      R$ ${formData.concorrentes.length > 0 ? 
                        (formData.concorrentes.reduce((acc, comp) => acc + (parseFloat(comp.preco) || 0), 0) / formData.concorrentes.length).toLocaleString('pt-BR') : 
                        '0'}
                    </span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="result-highlight">
              <h4 class="font-bold">üéØ Recomenda√ß√£o de Pre√ßo</h4>
              <div class="result-grid">
                <div class="result-item">
                  <div class="result-item-label">Pre√ßo M√≠nimo</div>
                  <div class="result-item-value">R$ ${results.precoMinimo.toLocaleString('pt-BR')}</div>
                  <div class="result-item-label">Limite para viabilidade</div>
                </div>
                <div class="result-item">
                  <div class="result-item-label">Pre√ßo Sugerido</div>
                  <div class="result-item-value">R$ ${results.precoSugerido.toLocaleString('pt-BR')}</div>
                  <div class="result-item-label">Baseado na estrat√©gia</div>
                </div>
                <div class="result-item">
                  <div class="result-item-label">Margem Final</div>
                  <div class="result-item-value">${results.margemFinal}%</div>
                  <div class="result-item-label">Lucro l√≠quido estimado</div>
                </div>
              </div>
            </div>
            
            <div class="grid-2">
              <div class="validation-box blue">
                <h4 class="font-medium mb-3">üìà Proje√ß√£o de Performance</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span>VSO Projetada:</span>
                    <span class="font-medium">${results.vsoProjetada}% ao m√™s</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Tempo de vendas (100 un):</span>
                    <span class="font-medium">${(100 / results.vsoProjetada).toFixed(0)} meses</span>
                  </div>
                  <div class="flex justify-between">
                    <span>Status VSO:</span>
                    <span class="font-medium ${results.vsoProjetada >= 2.5 ? 'text-green' : 'text-red'}">
                      ${results.vsoProjetada >= 3 ? 'Excelente' : results.vsoProjetada >= 2.5 ? 'Boa' : 'Baixa'}
                    </span>
                  </div>
                </div>
              </div>
              
              <div class="validation-box yellow">
                <h4 class="font-medium mb-3">‚ö†Ô∏è Valida√ß√µes Cr√≠ticas</h4>
                <div class="space-y-1 text-sm">
                  <div class="flex items-center ${results.som >= 50 ? 'text-green' : 'text-red'}">
                    <i class="fas ${results.som >= 50 ? 'fa-check-circle' : 'fa-exclamation-triangle'} icon mr-2"></i>
                    <span>SOM vs Demanda ${results.som >= 50 ? '‚úì' : '‚úó'}</span>
                  </div>
                  <div class="flex items-center ${results.margemFinal >= 20 ? 'text-green' : 'text-red'}">
                    <i class="fas ${results.margemFinal >= 20 ? 'fa-check-circle' : 'fa-exclamation-triangle'} icon mr-2"></i>
                    <span>Margem M√≠nima ${results.margemFinal >= 20 ? '‚úì' : '‚úó'}</span>
                  </div>
                  <div class="flex items-center ${results.vsoProjetada >= 2 ? 'text-green' : 'text-red'}">
                    <i class="fas ${results.vsoProjetada >= 2 ? 'fa-check-circle' : 'fa-exclamation-triangle'} icon mr-2"></i>
                    <span>VSO Vi√°vel ${results.vsoProjetada >= 2 ? '‚úì' : '‚úó'}</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="validation-box">
              <h4 class="font-medium mb-3">üéØ Pr√≥ximos Passos</h4>
              <div class="grid-2">
                <div>
                  <h5 class="font-medium mb-2">Implementa√ß√£o:</h5>
                  <ul class="space-y-1">
                    <li>‚Ä¢ Validar pre√ßo com equipe comercial</li>
                    <li>‚Ä¢ Testar em pr√©-lan√ßamento limitado</li>
                    <li>‚Ä¢ Preparar argumenta√ß√£o de vendas</li>
                    <li>‚Ä¢ Definir estrat√©gia de lan√ßamento</li>
                  </ul>
                </div>
                <div>
                  <h5 class="font-medium mb-2">Monitoramento:</h5>
                  <ul class="space-y-1">
                    <li>‚Ä¢ Acompanhar VSO semanal</li>
                    <li>‚Ä¢ Monitorar concorr√™ncia</li>
                    <li>‚Ä¢ Avaliar ajustes trimestrais</li>
                    <li>‚Ä¢ Medir satisfa√ß√£o dos clientes</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="validation-box green">
              <div class="flex-center">
                <i class="fas fa-check-circle icon"></i>
                <div>
                  <h4 class="font-medium">An√°lise Conclu√≠da!</h4>
                  <p class="text-sm mt-1">
                    Seu framework de precifica√ß√£o est√° completo. Use as recomenda√ß√µes como base para a decis√£o final, 
                    sempre considerando fatores espec√≠ficos do seu projeto e mercado local.
                  </p>
                </div>
              </div>
            </div>
          </div>
        `;
      }
      
      function render() {
        const app = document.getElementById('app');
        if (!app) return;
        
        calculateResults();
        
        app.innerHTML = `
          <div class="container">
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
              <div class="header">
                <h1>Framework Interativo de Precifica√ß√£o MCMV</h1>
                <p>Guia completo para definir o pre√ßo ideal do seu empreendimento</p>
              </div>
              
              <div class="progress-container">
                <div class="progress-info">
                  <span class="font-medium">Etapa ${state.currentStep + 1} de ${state.steps.length}</span>
                  <span>${Math.round(((state.currentStep + 1) / state.steps.length) * 100)}% completo</span>
                </div>
                <div class="progress-bar">
                  <div 
                    class="progress-fill"
                    style="width: ${((state.currentStep + 1) / state.steps.length) * 100}%"
                  ></div>
                </div>
              </div>
              
              <div class="steps-navigation">
                ${state.steps.map((step, index) => {
                  let buttonClass = "step-button";
                  
                  if (state.currentStep === index) {
                    buttonClass += " active";
                  } else if (state.currentStep > index) {
                    buttonClass += " completed";
                  }
                  
                  return `
                    <button
                      onclick="state.currentStep = ${index}; render()"
                      class="${buttonClass}"
                    >
                      <i class="fas fa-${step.icon}"></i>
                      <span>${step.title}</span>
                      ${state.currentStep > index ? '<i class="fas fa-check"></i>' : ''}
                    </button>
                  `;
                }).join('')}
              </div>
              
              <div class="content-container">
                <div class="step-header">
                  <h2>${state.steps[state.currentStep].title}</h2>
                  <p>${state.steps[state.currentStep].description}</p>
                </div>
                
                ${renderStep()}
              </div>
              
              <div class="navigation">
                <button
                  onclick="state.currentStep = Math.max(0, state.currentStep - 1); render()"
                  ${state.currentStep === 0 ? 'disabled' : ''}
                  class="button ${state.currentStep === 0 ? 'disabled' : ''}"
                >
                  <i class="fas fa-chevron-left"></i>
                  <span>Anterior</span>
                </button>
                
                <button
                  onclick="state.currentStep = Math.min(${state.steps.length - 1}, state.currentStep + 1); render()"
                  ${state.currentStep === state.steps.length - 1 ? 'disabled' : ''}
                  class="button primary ${state.currentStep === state.steps.length - 1 ? 'disabled' : ''}"
                >
                  <span>Pr√≥ximo</span>
                  <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>
          </div>
        `;
      }
      
      // Inicializa a aplica√ß√£o
      render();
      
      // Torna as fun√ß√µes globais para os event handlers
      window.updateFormData = updateFormData;
      window.addConcorrente = addConcorrente;
      window.updateConcorrente = updateConcorrente;
      window.removeConcorrente = removeConcorrente;
      window.state = state;
      window.render = render;
    });
  </script>
</body>
</html>
